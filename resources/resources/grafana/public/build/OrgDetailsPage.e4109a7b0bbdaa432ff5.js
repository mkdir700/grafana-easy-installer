"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[1510],{39745:(N,P,e)=>{e.d(P,{A:()=>h,u:()=>T});var r=e(32196),a=e(96540),y=e(97594),D=e(41987),E=e(13544),l=e(14110),U=e(32264),g=e(84167),c=e(88575),O=e(88323),v=e(60029),A=e(20333),I=e(15648),W=e(86460),_=e(55852),S=e(3911),C=e(59429),n=e(44836),f=e(74513),L=e(65615),R=e(2769);function x(){const o=f.Yj.map(t=>({value:t.code,label:t.name})).sort((t,m)=>t.value===f.wi?1:m.value===f.wi?-1:t.label.localeCompare(m.label));return[{value:"",label:(0,n.t)("common.locale.default","Default")},...o]}class T extends a.PureComponent{constructor(s){super(s),this.onSubmitForm=async t=>{if(t.preventDefault(),this.props.onConfirm?await this.props.onConfirm():!0){const{homeDashboardUID:K,theme:z,timezone:B,weekStart:p,language:M,queryHistory:b}=this.state;await this.service.update({homeDashboardUID:K,theme:z,timezone:B,weekStart:p,language:M,queryHistory:b}),window.location.reload()}},this.onThemeChanged=t=>{this.setState({theme:t.value}),t.value&&(0,R.K)(t.value,!0)},this.onTimeZoneChanged=t=>{typeof t=="string"&&this.setState({timezone:t})},this.onWeekStartChanged=t=>{this.setState({weekStart:t})},this.onHomeDashboardChanged=t=>{this.setState({homeDashboardUID:t})},this.onLanguageChanged=t=>{this.setState({language:t}),(0,l.rR)("grafana_preferences_language_changed",{toLanguage:t,preferenceType:this.props.preferenceType})},this.service=new L.W(s.resourceUri),this.state={theme:"",timezone:"",weekStart:"",language:"",queryHistory:{homeTab:""}},this.themeOptions=(0,y.k)(U.$.featureToggles.extraThemes).map(t=>({value:t.id,label:u(t)})),this.themeOptions.unshift({value:"",label:(0,n.t)("shared-preferences.theme.default-label","Default")})}async componentDidMount(){const s=await this.service.load();this.setState({homeDashboardUID:s.homeDashboardUID,theme:s.theme,timezone:s.timezone,weekStart:s.weekStart,language:s.language,queryHistory:s.queryHistory})}render(){const{theme:s,timezone:t,weekStart:m,homeDashboardUID:K,language:z}=this.state,{disabled:B}=this.props,p=i(),M=x(),b=this.themeOptions.find(d=>d.value===s)??this.themeOptions[0];return a.createElement("form",{onSubmit:this.onSubmitForm,className:p.form},a.createElement(g.n,{label:a.createElement(n.x6,{i18nKey:"shared-preferences.title"},"Preferences"),disabled:B},a.createElement(c.D,{label:(0,n.t)("shared-preferences.fields.theme-label","Interface theme")},a.createElement(O.l6,{options:this.themeOptions,value:b,onChange:this.onThemeChanged,inputId:"shared-preferences-theme-select"})),a.createElement(c.D,{label:a.createElement(v.J,{htmlFor:"home-dashboard-select"},a.createElement("span",{className:p.labelText},a.createElement(n.x6,{i18nKey:"shared-preferences.fields.home-dashboard-label"},"Home Dashboard"))),"data-testid":"User preferences home dashboard drop down"},a.createElement(C.b,{value:K,onChange:d=>this.onHomeDashboardChanged(d?.uid??""),defaultOptions:!0,isClearable:!0,placeholder:(0,n.t)("shared-preferences.fields.home-dashboard-placeholder","Default dashboard"),inputId:"home-dashboard-select"})),a.createElement(c.D,{label:(0,n.t)("shared-dashboard.fields.timezone-label","Timezone"),"data-testid":E.Tp.components.TimeZonePicker.containerV2},a.createElement(A.U,{includeInternal:!0,value:t,onChange:this.onTimeZoneChanged,inputId:"shared-preferences-timezone-picker"})),a.createElement(c.D,{label:(0,n.t)("shared-preferences.fields.week-start-label","Week start"),"data-testid":E.Tp.components.WeekStartPicker.containerV2},a.createElement(I.l,{value:m||"",onChange:this.onWeekStartChanged,inputId:"shared-preferences-week-start-picker"})),a.createElement(c.D,{label:a.createElement(v.J,{htmlFor:"locale-select"},a.createElement("span",{className:p.labelText},a.createElement(n.x6,{i18nKey:"shared-preferences.fields.locale-label"},"Language")),a.createElement(W.y,{featureState:D.Ay.beta})),"data-testid":"User preferences language drop down"},a.createElement(O.l6,{value:M.find(d=>d.value===z),onChange:d=>this.onLanguageChanged(d.value??""),options:M,placeholder:(0,n.t)("shared-preferences.fields.locale-placeholder","Choose language"),inputId:"locale-select"}))),a.createElement(_.$n,{type:"submit",variant:"primary","data-testid":E.Tp.components.UserProfile.preferencesSaveButton},a.createElement(n.x6,{i18nKey:"common.save"},"Save")))}}const h=T,i=(0,S.N)(()=>({labelText:(0,r.css)({marginRight:"6px"}),form:(0,r.css)({width:"100%",maxWidth:"600px"})}));function u(o){switch(o.id){case"dark":return(0,n.t)("shared.preferences.theme.dark-label","Dark");case"light":return(0,n.t)("shared.preferences.theme.light-label","Light");case"system":return(0,n.t)("shared.preferences.theme.system-label","System preference");default:return o.name}}},69047:(N,P,e)=>{e.r(P),e.d(P,{OrgDetailsPage:()=>f,default:()=>T});var r=e(96540),a=e(63329),y=e(66864),D=e(17205),E=e(39745),l=e(10096),U=e(17422),g=e(31678),c=e(28444),O=e(84167),v=e(88575),A=e(10354),I=e(55852),W=e(72235);const S=({onSubmit:h,orgName:i})=>{const u=l.TP.hasPermission(g.AccessControlAction.OrgsWrite);return r.createElement(W.l,{defaultValues:{orgName:i},onSubmit:({orgName:o})=>h(o)},({register:o})=>r.createElement(O.n,{label:"Organization profile",disabled:!u},r.createElement(v.D,{label:"Organization name"},r.createElement(A.p,{id:"org-name-input",type:"text",...o("orgName",{required:!0})})),r.createElement(I.$n,{type:"submit"},"Update organization name")))};var C=e(32931),n=e(10943);class f extends r.PureComponent{constructor(){super(...arguments),this.onUpdateOrganization=i=>{this.props.setOrganizationName(i),this.props.updateOrganization()},this.handleConfirm=()=>new Promise(i=>{l.lE.publish(new c.bY({title:"Confirm preferences update",text:"This will update the preferences for the whole organization. Are you sure you want to update the preferences?",yesText:"Save",yesButtonVariant:"primary",onConfirm:async()=>i(!0),onDismiss:async()=>i(!1)}))})}async componentDidMount(){await this.props.loadOrganization()}render(){const{navModel:i,organization:u}=this.props,o=Object.keys(u).length===0,s=l.TP.hasPermission(g.AccessControlAction.OrgsRead),t=l.TP.hasPermission(g.AccessControlAction.OrgsPreferencesRead),m=l.TP.hasPermission(g.AccessControlAction.OrgsPreferencesWrite);return r.createElement(D.Y,{navModel:i},r.createElement(D.Y.Contents,{isLoading:o},!o&&r.createElement(y.gW,{spacing:"lg"},s&&r.createElement(S,{onSubmit:this.onUpdateOrganization,orgName:u.name}),t&&r.createElement(E.A,{resourceUri:"org",disabled:!m,preferenceType:"org",onConfirm:this.handleConfirm}))))}}function L(h){return{navModel:(0,U.tc)(h.navIndex,"org-settings"),organization:h.organization.organization}}const R={loadOrganization:C.YS,setOrganizationName:n.n,updateOrganization:C.L_},T=(0,a.connect)(L,R)(f)}}]);

//# sourceMappingURL=OrgDetailsPage.e4109a7b0bbdaa432ff5.js.map