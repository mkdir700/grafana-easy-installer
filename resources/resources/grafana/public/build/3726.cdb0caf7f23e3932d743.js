"use strict";(self.webpackChunkgrafana=self.webpackChunkgrafana||[]).push([[3726],{13726:(X,I,t)=>{t.r(I),t.d(I,{ContactPoint:()=>Ae,ContactPointReceiverSummary:()=>Pe,ContactPointReceiverTitleRow:()=>Se,default:()=>st});var u=t(32196),M=t(53076),P=t(2543),R=t(55127),W=t.n(R),e=t(96540),U=t(52594),N=t(42941),z=t(47232),K=t(42418),S=t(67061),$=t(63021),G=t(40675),V=t(40980),T=t(39558),a=t(55852),s=t(94753),A=t(19384),g=t(40845),h=t(38138),E=t(56034),x=t(83122),l=t(14578),C=t(23896);const p={pagerduty:"PagerDuty",pushover:"Pushover",slack:"Slack",opsgenie:"OpsGenie",webhook:"Webhook",victorops:"VictorOps",wechat:"WeChat",discord:"Discord",webex:"Cisco Webex Teams",sns:"Amazon SNS",telegram:"Telegram",msteams:"Microsoft Teams"};var d=t(19073),D=t(98439),w=t(39964),Q=t(70383),J=t(19645),te=t(57220),k=t(3704),ne=t(57895),L=t(55196),H=t(90141),ie=t(48205),ae=t(26058),se=t(94855),fe=t(79938),Ee=t(16293),ve=t(76648),he=t(84029);const Le=({receiverName:n,decrypt:o,exportFormat:r,onClose:i})=>{const{currentData:c="",isFetching:m}=fe.hK.useExportReceiverQuery({receiverName:n,decrypt:o,format:r}),y=`cp-${n}-${new Date().getTime()}`;return m?e.createElement(T._,{text:"Loading...."}):e.createElement(Ee.J,{format:r,textDefinition:c,downloadFileName:y,onClose:i})},De=({onClose:n,receiverName:o,decrypt:r})=>{const[i,c]=(0,e.useState)("yaml");return e.createElement(ve.m,{activeTab:i,onTabChange:c,onClose:n,formatProviders:Object.values(he.sl)},e.createElement(Le,{receiverName:o,decrypt:r,exportFormat:i,onClose:n}))},Ie=({decrypt:n,exportFormat:o,onClose:r})=>{const{currentData:i="",isFetching:c}=fe.hK.useExportReceiversQuery({decrypt:n,format:o}),m=`contact-points-${new Date().getTime()}`;return c?e.createElement(T._,{text:"Loading...."}):e.createElement(Ee.J,{format:o,textDefinition:i,downloadFileName:m,onClose:r})},Me=({onClose:n,decrypt:o})=>{const[r,i]=(0,e.useState)("yaml");return e.createElement(ve.m,{activeTab:r,onTabChange:i,onClose:n,formatProviders:Object.values(he.sl)},e.createElement(Ie,{decrypt:o,exportFormat:r,onClose:n}))},xe=({metadata:{icon:n,title:o,externalUrl:r,warning:i}})=>{const c=(0,g.of)(Oe);return e.createElement(S.B,{alignItems:"center",gap:.5},e.createElement(S.B,{direction:"row",alignItems:"center",gap:.5},i?e.createElement(E.m,{content:i,theme:"error"},e.createElement(l.I,{name:"exclamation-triangle",className:c.warnIcon})):e.createElement("img",{src:n,alt:o,height:"16px"}),e.createElement("span",null,o)),r&&e.createElement(a.z9,{icon:"external-link-alt",href:r,target:"_blank",variant:"secondary",size:"sm"}))},Oe=n=>({warnIcon:(0,u.css)({fill:n.colors.warning.text})});var Ne=t(51488),Be=t(96374),Fe=t(31678),oe=t(64853),We=t(23770),Ue=t(4554),le=t(56361),Ke=t(64047),$e=t(84396),ce=t(72275),Ge=t(96615);const Ve=({config:n,alertManagerName:o})=>{const r=(0,Fe.useDispatch)(),[i,c]=(0,e.useState)({}),m=(0,g.of)(Ue.L),y=(0,e.useMemo)(()=>Object.entries(n.template_files).map(([B,O])=>({name:B,template:O,provenance:(n.template_file_provenances??{})[B]})),[n]),[f,v]=(0,e.useState)(),F=()=>{f&&r((0,We.EY)(f,o)),v(void 0)};return e.createElement(e.Fragment,null,e.createElement("table",{className:m.table,"data-testid":"templates-table"},e.createElement("colgroup",null,e.createElement("col",{className:m.colExpand}),e.createElement("col",null),e.createElement("col",null)),e.createElement("thead",null,e.createElement("tr",null,e.createElement("th",null),e.createElement("th",null,"Template"),e.createElement(oe._,{actions:[d.QI.CreateNotificationTemplate,d.QI.UpdateNotificationTemplate,d.QI.DeleteNotificationTemplate]},e.createElement("th",null,"Actions")))),e.createElement("tbody",null,!y.length&&e.createElement("tr",{className:m.evenRow},e.createElement("td",{colSpan:3},"No templates defined.")),y.map(({name:b,template:B,provenance:O},j)=>{const Y=!!i[b];return e.createElement(e.Fragment,{key:b},e.createElement("tr",{key:b,className:j%2===0?m.evenRow:void 0},e.createElement("td",null,e.createElement(Ke.e,{isCollapsed:!i[b],onToggle:()=>c({...i,[b]:!Y})})),e.createElement("td",null,b," ",O&&e.createElement(ie.rS,null)),e.createElement("td",{className:m.actionsCell},O&&e.createElement(ce.M,{to:(0,le.nL)(`/alerting/notifications/templates/${encodeURIComponent(b)}/edit`,o),tooltip:"view template",icon:"file-alt"}),!O&&e.createElement(oe._,{actions:[d.QI.UpdateNotificationTemplate]},e.createElement(ce.M,{to:(0,le.nL)(`/alerting/notifications/templates/${encodeURIComponent(b)}/edit`,o),tooltip:"edit template",icon:"pen"})),e.createElement(oe._,{actions:[d.QI.CreateContactPoint]},e.createElement(ce.M,{to:(0,le.nL)(`/alerting/notifications/templates/${encodeURIComponent(b)}/duplicate`,o),tooltip:"Copy template",icon:"copy"})),!O&&e.createElement(oe._,{actions:[d.QI.DeleteNotificationTemplate]},e.createElement(ce.M,{onClick:()=>v(b),tooltip:"delete template",icon:"trash-alt"})))),Y&&e.createElement("tr",{className:j%2===0?m.evenRow:void 0},e.createElement("td",null),e.createElement("td",{colSpan:2},e.createElement($e.X,{label:"Description",horizontal:!0},e.createElement(Ge.K,{width:"auto",height:"auto",autoHeight:!0,value:B,showLineNumbers:!1,monacoOptions:{readOnly:!0,scrollBeyondLastLine:!1}})))))}))),!!f&&e.createElement(Be.u,{isOpen:!0,title:"Delete template",body:`Are you sure you want to delete template "${f}"?`,confirmText:"Yes, delete",onConfirm:F,onDismiss:()=>v(void 0)}))},we=()=>{const{selectedAlertmanager:n}=(0,Q.VI)(),{data:o,error:r}=(0,Ne.f)(n);return r?e.createElement(K.F,{title:"Failed to fetch notification templates"},String(r)):o?e.createElement(Ve,{config:o,alertManagerName:n}):null};var ze=t(40996),Qe=t(46819),He=t(88575),je=t(10354);const Ye=()=>{const n=(0,g.of)(Xe),[o,r]=(0,w.l)(),i=o.get("search")??"",[c,m]=(0,e.useState)(i),[y,f]=(0,ze.A)(()=>{r({search:c},!0)},300,[r,c]),v=(0,e.useCallback)(()=>{f(),m(""),r({search:""},!0)},[f,r]),F=!!i;return e.createElement(Qe.B,{direction:"row",alignItems:"end",gap:.5},e.createElement(He.D,{className:n.noBottom,label:"Search by name or type"},e.createElement(je.p,{"aria-label":"search contact points",placeholder:"Search",width:46,prefix:e.createElement(l.I,{name:"search"}),onChange:b=>{m(b.currentTarget.value)},value:c})),e.createElement(a.$n,{variant:"secondary",icon:"times",onClick:()=>v(),disabled:!F,"aria-label":"clear"},"Clear"))},Xe=()=>({noBottom:(0,u.css)({marginBottom:0})}),Je=({alertManagerName:n})=>{const o=(0,te.AL)(n);return e.createElement(oe._,{actions:[d.QI.UpdateExternalConfiguration]},e.createElement(K.F,{severity:"info",title:"Global config for contact points"},e.createElement("p",null,"For each external Alertmanager you can define global settings, like server addresses, usernames and password, for all the supported contact points."),e.createElement(a.z9,{href:(0,le.nL)("alerting/notifications/global-config",n),variant:"secondary"},o?"View global config":"Edit global config")))};var ge=t(37390);const ke=(n,o)=>{const[r,i]=(0,e.useState)(!1),[c,m]=(0,e.useState)(),[y,f]=(0,e.useState)(),v=(0,e.useCallback)(()=>{o||(m(void 0),i(!1),f(void 0))},[o]),F=(0,e.useCallback)(O=>{m(O),i(!0),f(void 0)},[]),b=(0,e.useCallback)(()=>{c&&n(c).then(()=>i(!1)).catch(f)},[n,c]);return[(0,e.useMemo)(()=>y?e.createElement(Ze,{isOpen:r,onDismiss:v,error:y}):e.createElement(ge.a,{isOpen:r,onDismiss:v,closeOnBackdropClick:!o,closeOnEscape:!o,title:"Delete contact point"},e.createElement("p",null,"Deleting this contact point will permanently remove it."),e.createElement("p",null,"Are you sure you want to delete this contact point?"),e.createElement(ge.a.ButtonRow,null,e.createElement(a.$n,{type:"button",variant:"destructive",onClick:b,disabled:o},o?"Deleting...":"Yes, delete contact point"),e.createElement(a.$n,{type:"button",variant:"secondary",onClick:v,disabled:o},"Cancel"))),[y,v,b,o,r]),F,v]},Ze=({isOpen:n,onDismiss:o,error:r})=>e.createElement(ge.a,{isOpen:n,onDismiss:o,closeOnBackdropClick:!0,closeOnEscape:!0,title:"Something went wrong"},e.createElement("p",null,"Failed to update your configuration:"),e.createElement("p",null,e.createElement("pre",null,e.createElement("code",null,(0,le.JZ)(r)))));var qe=t(39938);const _e=()=>e.createElement(qe.E,{text:"Unused","aria-label":"unused",color:"orange",icon:"exclamation-triangle",tooltip:"This contact point is not used in any notification policy"});var Z=t(79381),Ce=t(77141),et=(n=>(n[n.ContactPoints=0]="ContactPoints",n[n.NotificationTemplates=1]="NotificationTemplates",n))(et||{});const ye=10,tt=()=>{const{selectedAlertmanager:n}=(0,Q.VI)(),[o,r]=(0,e.useState)(0);let{isLoading:i,error:c,contactPoints:m}=(0,Z.dK)();const{deleteTrigger:y,updateAlertmanagerState:f}=(0,Z.$x)(n),[v,F]=(0,d.L7)(d.QI.CreateContactPoint),[b,B]=(0,d.L7)(d.QI.ExportContactPoint),[O,j]=(0,d.L7)(d.QI.CreateNotificationTemplate),[Y,re]=ke(y,f.isLoading),[me,pe]=Te(),[_]=(0,w.l)(),{search:ue}=it(_),q=o===0,ee=o===1;if(c)return e.createElement(K.F,{title:"Failed to fetch contact points"},c.message);const ct=n===te.hY;return e.createElement(e.Fragment,null,e.createElement(ne.M,{currentAlertmanager:n}),e.createElement(S.B,{direction:"column"},e.createElement($.U,null,e.createElement(G.o,{label:"Contact Points",active:q,counter:m.length,onChangeTab:()=>r(0)}),e.createElement(G.o,{label:"Notification Templates",active:ee,onChangeTab:()=>r(1)})),e.createElement(V.J,null,e.createElement(S.B,{direction:"column"},e.createElement(e.Fragment,null,i&&e.createElement(T._,{text:"Loading..."}),q&&e.createElement(e.Fragment,null,c?e.createElement(K.F,{title:"Failed to fetch contact points"},String(c)):e.createElement(e.Fragment,null,e.createElement(S.B,{direction:"row",alignItems:"end"},e.createElement(Ye,null),e.createElement(ae.h,null),e.createElement(S.B,{direction:"row",gap:1},v&&e.createElement(a.z9,{icon:"plus","aria-label":"add contact point",variant:"primary",href:"/alerting/notifications/receivers/new",disabled:!F},"Add contact point"),b&&e.createElement(a.$n,{icon:"download-alt",variant:"secondary","aria-label":"export all",disabled:!B,onClick:()=>pe(Re)},"Export all"))),e.createElement(nt,{contactPoints:m,search:ue,pageSize:ye,onDelete:dt=>re(dt),disabled:f.isLoading}),!ct&&e.createElement(Je,{alertManagerName:n}))),ee&&e.createElement(e.Fragment,null,e.createElement(S.B,{direction:"row",alignItems:"center"},e.createElement(s.E,{variant:"body",color:"secondary"},"Create notification templates to customize your notifications."),e.createElement(ae.h,null),O&&e.createElement(a.z9,{icon:"plus",variant:"primary",href:"/alerting/notifications/templates/new",disabled:!j},"Add notification template")),e.createElement(we,null)))))),Y,me)},nt=({contactPoints:n,disabled:o=!1,search:r,pageSize:i=ye,onDelete:c})=>{const m=at(n,r),{page:y,pageItems:f,numberOfPages:v,onPageChange:F}=(0,D.W)(m,1,i);return e.createElement(e.Fragment,null,f.map((b,B)=>{const O=(0,Ce.NY)(b),j=b.policies??[],Y=`${b.name}-${B}`;return e.createElement(Ae,{key:Y,name:b.name,disabled:o,onDelete:c,receivers:b.grafana_managed_receiver_configs,provisioned:O,policies:j})}),e.createElement(A.d,{currentPage:y,numberOfPages:v,onNavigate:F,hideWhenSinglePage:!0}))},be=new M.A({intraMode:1,intraIns:1,intraSub:1,intraDel:1,intraTrn:1});function at(n,o){const r=(0,e.useMemo)(()=>n.map(f=>f.name),[n]),i=(0,e.useMemo)(()=>n.map(f=>f.grafana_managed_receiver_configs.map(v=>v[Z.MX].name).join(" ")),[n]);if(!o)return n;const c=be.filter(r,o)??[],m=be.filter(i,o)??[],y=[...c,...m];return(0,P.uniq)(y).map(f=>n[f])??[]}const Ae=({name:n,disabled:o=!1,provisioned:r=!1,receivers:i,policies:c=[],onDelete:m})=>{const y=(0,g.of)(de),f=i.some(v=>!!v[Z.v4]);return e.createElement("div",{className:y.contactPointWrapper,"data-testid":"contact-point"},e.createElement(S.B,{direction:"column",gap:0},e.createElement(ot,{name:n,policies:c,provisioned:r,disabled:o,onDelete:m}),f?e.createElement("div",null,i.map((v,F)=>{const b=v[Z.v4],B=v[Z.MX],O=!v.disableResolveMessage,j=v[Z.sW],Y=B.name+F;return e.createElement(lt,{key:Y,name:B.name,type:v.type,description:(0,Ce.aM)(v),diagnostics:b,pluginMetadata:j,sendingResolved:O})})):e.createElement("div",{className:y.integrationWrapper},e.createElement(Pe,{receivers:i}))))},ot=n=>{const{name:o,disabled:r=!1,provisioned:i=!1,policies:c=[],onDelete:m}=n,y=(0,g.of)(de),[f,v]=(0,d.L7)(d.QI.ExportContactPoint),[F,b]=(0,d.L7)(d.QI.UpdateContactPoint),[B,O]=(0,d.L7)(d.QI.UpdateContactPoint),[j,Y]=Te(),re=c.length,me=re>0,pe=c.some(ee=>ee.route.type!=="auto-generated"),_=F&&b&&!i,ue=B&&O&&!i&&!pe,q=[];return f&&q.push(e.createElement(e.Fragment,{key:"export-contact-point"},e.createElement(h.W.Item,{icon:"download-alt",label:"Export",ariaLabel:"export",disabled:!v,"data-testid":"export",onClick:()=>Y(o)}),e.createElement(h.W.Divider,null))),B&&q.push(e.createElement(C.A,{key:"delete-contact-point",shouldWrap:!ue,wrap:ee=>e.createElement(E.m,{content:"Contact point is currently in use by one or more notification policies",placement:"top"},e.createElement("span",null,ee))},e.createElement(h.W.Item,{label:"Delete",ariaLabel:"delete",icon:"trash-alt",destructive:!0,disabled:r||!ue,onClick:()=>m(o)}))),e.createElement("div",{className:y.headerWrapper},e.createElement(S.B,{direction:"row",alignItems:"center",gap:1},e.createElement(S.B,{alignItems:"center",gap:1},e.createElement(s.E,{variant:"body",weight:"medium"},o)),me&&e.createElement(L.P,null,e.createElement(U.Link,{to:(0,k.c)("/alerting/routes",{contactPoint:o})},"is used by ",e.createElement(se.O,null,re)," ",W()("notification policy",re))),i&&e.createElement(ie.rS,null),!me&&e.createElement(_e,null),e.createElement(ae.h,null),e.createElement(a.z9,{tooltipPlacement:"top",tooltip:i?"Provisioned contact points cannot be edited in the UI":void 0,variant:"secondary",size:"sm",icon:_?"pen":"eye",type:"button",disabled:r,"aria-label":`${_?"edit":"view"}-action`,"data-testid":`${_?"edit":"view"}-action`,href:`/alerting/notifications/receivers/${encodeURIComponent(o)}/edit`},_?"Edit":"View"),q.length>0&&e.createElement(x.m,{overlay:e.createElement(h.W,null,q)},e.createElement(H.A,null))),j)},lt=n=>{const{name:o,type:r,description:i,diagnostics:c,pluginMetadata:m,sendingResolved:y=!0}=n,f=(0,g.of)(de),v=c!==void 0;return e.createElement("div",{className:f.integrationWrapper},e.createElement(S.B,{direction:"column",gap:.5},e.createElement(Se,{name:o,type:r,description:i,pluginMetadata:m}),v&&e.createElement(rt,{diagnostics:c,sendingResolved:y})))};function Se(n){const{name:o,type:r,description:i,pluginMetadata:c}=n,m=J.M[r];return e.createElement(S.B,{direction:"row",alignItems:"center",gap:1},e.createElement(S.B,{direction:"row",alignItems:"center",gap:.5},m&&e.createElement(l.I,{name:m}),c?e.createElement(xe,{metadata:c}):e.createElement(s.E,{variant:"body",color:"primary"},o)),i&&e.createElement(s.E,{variant:"bodySmall",color:"secondary"},i))}const Pe=({receivers:n})=>{const o=(0,P.groupBy)(n,r=>r.type);return e.createElement(S.B,{direction:"column",gap:0},e.createElement(S.B,{direction:"row",alignItems:"center",gap:1},Object.entries(o).map(([r,i],c)=>{const m=J.M[r],y=p[r]??(0,P.upperFirst)(r),f=(0,P.size)(o)-1===c;return e.createElement(e.Fragment,{key:r},e.createElement(S.B,{direction:"row",alignItems:"center",gap:.5},m&&e.createElement(l.I,{name:m}),e.createElement(s.E,{variant:"body"},y,i.length>1&&e.createElement(e.Fragment,null," (",i.length,")"))),!f&&"\u22C5")})))},rt=({diagnostics:n,sendingResolved:o})=>{const r=(0,g.of)(de),i=!!n.lastNotifyAttemptError,c=(0,z.KQ)(n.lastNotifyAttempt),m=n.lastNotifyAttemptDuration,y=c.isValid();return e.createElement("div",{className:r.metadataRow},e.createElement(S.B,{direction:"row",gap:1},i?e.createElement(e.Fragment,null,e.createElement(L.P,{color:"error",icon:"exclamation-circle"},e.createElement(E.m,{content:n.lastNotifyAttemptError},e.createElement("span",null,"Last delivery attempt failed")))):e.createElement(e.Fragment,null,y&&e.createElement(e.Fragment,null,e.createElement(L.P,{icon:"clock-nine"},"Last delivery attempt"," ",e.createElement(E.m,{content:c.toLocaleString()},e.createElement("span",null,e.createElement(se.O,null,c.locale("en").fromNow())))),e.createElement(L.P,{icon:"stopwatch"},"took ",e.createElement(se.O,null,m))),!y&&e.createElement(L.P,{icon:"clock-nine"},"No delivery attempts"),!o&&e.createElement(L.P,{icon:"info-circle"},"Delivering ",e.createElement(se.O,null,"only firing")," notifications"))))},Re=Symbol("all contact points"),Te=()=>{const[n,o]=(0,e.useState)(null),[r,i]=(0,N.A)(!1),[c,m]=(0,d.L7)(d.QI.DecryptSecrets),y=c&&m,f=(0,e.useCallback)(()=>{o(null),i(!1)},[i]),v=b=>{o(b),i(!0)};return[(0,e.useMemo)(()=>!n||!r?null:n===Re?e.createElement(Me,{decrypt:y,onClose:f}):e.createElement(De,{receiverName:n,decrypt:y,onClose:f}),[y,r,f,n]),v]},it=n=>({search:n.get("search")??void 0}),de=n=>({contactPointWrapper:(0,u.css)({borderRadius:`${n.shape.radius.default}`,border:`solid 1px ${n.colors.border.weak}`,borderBottom:"none"}),integrationWrapper:(0,u.css)({position:"relative",background:`${n.colors.background.primary}`,padding:`${n.spacing(1)} ${n.spacing(1.5)}`,borderBottom:`solid 1px ${n.colors.border.weak}`}),headerWrapper:(0,u.css)({background:`${n.colors.background.secondary}`,padding:`${n.spacing(1)} ${n.spacing(1.5)}`,borderBottom:`solid 1px ${n.colors.border.weak}`,borderTopLeftRadius:`${n.shape.radius.default}`,borderTopRightRadius:`${n.shape.radius.default}`}),metadataRow:(0,u.css)({borderBottomLeftRadius:`${n.shape.radius.default}`,borderBottomRightRadius:`${n.shape.radius.default}`})}),st=tt},79381:(X,I,t)=>{t.d(I,{$x:()=>a,MX:()=>S,dK:()=>T,sW:()=>$,v4:()=>K});var u=t(1932),M=t(2543),P=t.n(M),R=t(82843),W=t(26423),e=t(12210),U=t(70383),N=t(99494),z=t(77141);const K=Symbol("receiver_status"),S=Symbol("receiver_metadata"),$=Symbol("receiver_plugin_metadata"),V={includePoliciesCount:!0,receiverStatusPollingInterval:10*1e3};function T({includePoliciesCount:s,receiverStatusPollingInterval:A}=V){const{selectedAlertmanager:g,isGrafanaAlertmanager:h}=(0,U.VI)(),{installed:E,loading:x}=(0,e._)(N.W.OnCall),l=R.m.endpoints.getContactPointsStatus.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,pollingInterval:A,skip:!h}),C=R.m.endpoints.grafanaNotifiers.useQuery(void 0,{skip:!h}),{data:p,isLoading:d}=W.WG.endpoints.grafanaOnCallIntegrations.useQuery(void 0,{skip:!E||!h});let D;E?D=p??[]:E===!1&&(D=null);const w=R.m.endpoints.getAlertmanagerConfiguration.useQuery(g,{refetchOnFocus:!0,refetchOnReconnect:!0,selectFromResult:L=>({...L,contactPoints:L.data?(0,z.Rm)(l.data,C.data,D,L.data.alertmanager_config.receivers??[],L.data):[]}),skip:!s}),Q=R.m.endpoints.getContactPointsList.useQuery(void 0,{refetchOnFocus:!0,refetchOnReconnect:!0,selectFromResult:L=>({...L,contactPoints:L.data?(0,z.Rm)(l.data,C.data,D,L.data,void 0):[]}),skip:s||!h}),J=w.error||Q.error||l.error,te=w.isLoading||Q.isLoading||l.isLoading||x||d,ne=(s?w.contactPoints:Q.contactPoints).sort((L,H)=>L.name.localeCompare(H.name));return{error:J,isLoading:te,contactPoints:ne,refetchReceivers:Q.refetch}}function a(s){const[A]=R.m.endpoints.getAlertmanagerConfiguration.useLazyQuery(),[g,h]=R.m.endpoints.updateAlertmanagerConfiguration.useMutation();return{deleteTrigger:x=>A(s).then(({data:l})=>{if(!l)return;const C=(0,u.jM)(l,p=>((0,M.remove)(p?.alertmanager_config?.receivers??[],d=>d.name===x),p));return g({selectedAlertmanager:s,config:C}).unwrap()}),updateAlertmanagerState:h}}},77141:(X,I,t)=>{t.d(I,{Rm:()=>g,aM:()=>s,NY:()=>a});var u=t(2543),M=t(32264),P=t(60021),R=t(79581);function W(l){return"grafana_managed_receiver_configs"in l?l.grafana_managed_receiver_configs??[]:Object.entries(l).filter(([p])=>p!=="grafana_managed_receiver_configs"&&p.endsWith("_configs")).filter(([p,d])=>Array.isArray(d)&&!(0,u.isEmpty)(d)).reduce((p,[d,D])=>{const w=d.replace("_configs",""),Q=(0,u.times)(D.length,()=>({name:l.name,type:w,settings:[],disableResolveMessage:!1}));return p.concat(Q)},[])}var e=t(37534),U=t(99494),N=t(76156),z=t(86768);const $={title:"Grafana OnCall",icon:z.K[U.W.OnCall]};function G(l,C){if(l===void 0)return $;if(l==null)return{...$,warning:"Grafana OnCall is not installed or is disabled"};const p=l.find(d=>d.integration_url===C.settings?.url);return{...$,description:p?.display_name,externalUrl:p?(0,N.h)(U.W.OnCall,`/integrations/${p.value}`):void 0,warning:p?void 0:"OnCall Integration no longer exists"}}var V=t(79381);const T="__grafana_receiver__";function a(l){return!!l.grafana_managed_receiver_configs?.find(p=>p.provenance)?.provenance}function s(l){if(l.settings)switch(l.type){case"email":return"addresses"in l.settings?A(l.settings.addresses):void 0;case"slack":{const C=l.settings.recipient;return C?`#${C.replace(/^#/,"")}`:void 0}case"kafka":return l.settings.kafkaTopic;case"webhook":return l.settings.url;case e.J4.OnCall:return l[V.sW]?.description;default:return l[V.MX]?.description}}function A(l){const p=/,|;|\n+/g,d=l.trim().split(p).map(u.trim),D=(0,u.take)(d,3),w=(0,u.difference)(d,D);return w.length&&D.push(`+${w.length} more`),D.join(", ")}function g(l=[],C=[],p,d,D){const w=(0,R._I)(D?.alertmanager_config?.route??{}),Q=E(w),J=(0,u.groupBy)(Q,"receiver");return(D?D?.alertmanager_config.receivers??[]:d??[]).map(k=>{const ne=W(k),L=l.find(H=>H.name===k.name);return{...k,policies:D&&J&&(J[k.name]??[]),grafana_managed_receiver_configs:ne.map((H,ie)=>{const ae=H.type===e.J4.OnCall;return{...H,[V.v4]:L?.integrations[ie],[V.MX]:x(C,H),[V.sW]:ae?G(p,H):void 0}})}})}function h(l){return!(M.$.featureToggles.alertingSimplifiedRouting??!1)||!l.object_matchers?!1:l.object_matchers.some(p=>p[0]===T&&p[1]===P.ho.equal)??!1}function E(l){const C=l.routes?.flatMap(p=>E(p))??[];return l.receiver?[{receiver:l.receiver,route:{type:h(l)?"auto-generated":"normal"}},...C]:C}function x(l,C){const p=l.find(d=>d.type===C.type);return{name:p?.name??(0,u.upperFirst)(C.type),description:p?.description}}},96615:(X,I,t)=>{t.d(I,{K:()=>T});var u=t(96540),M=t(32372),P=t(2543),R=t(83225);function W(a){const s=a.languages.CompletionItemKind.Function;return[{label:R.AlertmanagerTemplateFunction.toUpper,detail:"function(s string)",kind:s},{label:R.AlertmanagerTemplateFunction.toLower,detail:"function(s string)",kind:s},{label:R.AlertmanagerTemplateFunction.title,documentation:"Capitalizes the first letter of each word",detail:"function(s string)",kind:s},{label:R.AlertmanagerTemplateFunction.join,documentation:{value:"Joins an array of strings using the separator provided."},detail:"function(separator string, s []string)",kind:s},{label:R.AlertmanagerTemplateFunction.match,detail:"function",kind:s},{label:R.AlertmanagerTemplateFunction.safeHtml,detail:"function(pattern, repl, text)",kind:s},{label:R.AlertmanagerTemplateFunction.reReplaceAll,detail:"function(pattern, repl, text)",kind:s},{label:R.AlertmanagerTemplateFunction.stringSlice,detail:"function(s ...string)",kind:s}]}var e=t(57954);function U(a){const s={triggerCharacters:["."],provideCompletionItems(A,g,h){const E=A.getWordUntilPosition(g),x={startLineNumber:g.lineNumber,endLineNumber:g.lineNumber,startColumn:E.startColumn,endColumn:E.endColumn},l=new z(a,x);if(!N(A,g))return l.getSnippetsSuggestions();if(h.triggerKind===a.languages.CompletionTriggerKind.Invoke&&!h.triggerCharacter)return l.getFunctionsSuggestions();const p=A.getWordUntilPosition({lineNumber:g.lineNumber,column:g.column-1});return l.getTemplateDataSuggestions(p.word)}};return a.languages.registerCompletionItemProvider("go-template",s)}function N(a,s){const A={startLineNumber:s.lineNumber,endLineNumber:s.lineNumber,startColumn:a.getLineMinColumn(s.lineNumber),endColumn:a.getLineMaxColumn(s.lineNumber)};return a.findMatches('\\{\\{[a-zA-Z0-9._() "]+\\}\\}',A,!0,!1,null,!0).some(E=>E.range.containsPosition(s))}class z{constructor(s,A){this.monaco=s,this.range=A,this.getSnippetsSuggestions=()=>this.getCompletionsFromDefinitions((0,e.Mq)(this.monaco)),this.getFunctionsSuggestions=()=>this.getCompletionsFromDefinitions(W(this.monaco)),this.getTemplateDataSuggestions=g=>{switch(g){case"":return this.getCompletionsFromDefinitions((0,e.Xt)(this.monaco),(0,e.So)(this.monaco));case"Alerts":return this.getCompletionsFromDefinitions((0,e.J2)(this.monaco));case"GroupLabels":case"CommonLabels":case"CommonAnnotations":case"Labels":case"Annotations":return this.getCompletionsFromDefinitions((0,e.KS)(this.monaco));default:return{suggestions:[]}}},this.getCompletionsFromDefinitions=(...g)=>({suggestions:(0,P.concat)(...g).map(E=>K(E,this.range))})}}function K({label:a,detail:s,documentation:A,kind:g,insertText:h},E){const x=typeof a=="string"?a:a.label,l=typeof a=="string"?{label:a,description:s}:{...a};return l.description??=s,{label:l,kind:g,insertText:h??x,range:E,documentation:A,detail:s}}const S="go-template",G={id:S,extensions:[],aliases:[],mimetypes:[],loader:()=>Promise.resolve().then(t.bind(t,83225))},V=(a,s)=>{const{id:A,loader:g}=s;a.languages.getLanguages().find(E=>E.id===A)||(a.languages.register({id:A}),g().then(E=>{a.languages.setMonarchTokensProvider(A,E.language),a.languages.setLanguageConfiguration(A,E.conf)}))},T=a=>{const s=!!a.autoHeight,A=(0,u.useRef)(null),g=h=>{if(s){const E=h.getContentHeight();try{h.layout({height:E,width:NaN})}catch{}}};return(0,u.useEffect)(()=>()=>{A.current?.dispose()},[]),u.createElement(M.B,{showLineNumbers:!0,showMiniMap:!1,...a,onEditorDidMount:g,onBeforeEditorMount:h=>{V(h,G),A.current=U(h)},language:S})}},57954:(X,I,t)=>{t.d(I,{So:()=>K,J2:()=>S,Xt:()=>z,KS:()=>$,Mq:()=>V,L:()=>G});const u=`
{{ range .Alerts }}
  Status: {{ .Status }}
  Starts at: {{ .StartsAt }}
{{ end }}
`,M=`
[{{.Status}}] {{ .Labels.alertname }}

Labels:
{{ range .Labels.SortedPairs }}
  {{ .Name }}: {{ .Value }}
{{ end }}

{{ if gt (len .Annotations) 0 }}
Annotations:
{{ range .Annotations.SortedPairs }}
  {{ .Name }}: {{ .Value }}
{{ end }}
{{ end }}

{{ if gt (len .SilenceURL ) 0 }}
  Silence alert: {{ .SilenceURL }}
{{ end }}
{{ if gt (len .DashboardURL ) 0 }}
  Go to dashboard: {{ .DashboardURL }}
{{ end }}
`,P=N("GroupLabels.SortedPairs"),R=N("CommonLabels.SortedPairs"),W=N("CommonAnnotations.SortedPairs"),e=N("Labels.SortedPairs"),U=N("Annotations.SortedPairs");function N(T){return`
{{ range .${T} }}
  {{ .Name }} = {{ .Value }}
{{ end }}`}function z(T){const a=T.languages.CompletionItemKind.Field;return[{label:"Alerts",kind:a,detail:"Alert[]",documentation:{value:"An Array containing all alerts"}},{label:"Receiver",kind:a,detail:"string"},{label:"Status",kind:a,detail:"string"},{label:"GroupLabels",kind:a,detail:"[]KeyValue"},{label:"CommonLabels",kind:a,detail:"[]KeyValue"},{label:"CommonAnnotations",kind:a,detail:"[]KeyValue"},{label:"ExternalURL",kind:a,detail:"string"}]}function K(T){const a=T.languages.CompletionItemKind.Field;return[{label:{label:"Status",detail:"(Alert)",description:"string"},kind:a,detail:"string",documentation:{value:"Status of the alert. It can be `firing` or `resolved`"}},{label:{label:"Labels",detail:"(Alert)"},kind:a,detail:"[]KeyValue",documentation:{value:"A set of labels attached to the alert."}},{label:{label:"Annotations",detail:"(Alert)"},kind:a,detail:"[]KeyValue",documentation:"A set of annotations attached to the alert."},{label:{label:"StartsAt",detail:"(Alert)"},kind:a,detail:"time.Time",documentation:"Time the alert started firing."},{label:{label:"EndsAt",detail:"(Alert)"},kind:a,detail:"time.Time",documentation:"Only set if the end time of an alert is known. Otherwise set to a configurable timeout period from the time since the last alert was received."},{label:{label:"GeneratorURL",detail:"(Alert)"},kind:a,detail:"string",documentation:"Back link to Grafana or external Alertmanager."},{label:{label:"SilenceURL",detail:"(Alert)"},kind:a,detail:"string",documentation:"Link to Grafana silence for with labels for this alert pre-filled. Only for Grafana managed alerts."},{label:{label:"DashboardURL",detail:"(Alert)"},kind:a,detail:"string",documentation:"Link to Grafana dashboard, if alert rule belongs to one. Only for Grafana managed alerts."},{label:{label:"PanelURL",detail:"(Alert)"},kind:a,detail:"string",documentation:"Link to Grafana dashboard panel, if alert rule belongs to one. Only for Grafana managed alerts."},{label:{label:"Fingerprint",detail:"(Alert)"},kind:a,detail:"string",documentation:"Fingerprint that can be used to identify the alert."},{label:{label:"ValueString",detail:"(Alert)"},kind:a,detail:"string",documentation:"String that contains labels and values of each reduced expression in the alert."}]}function S(T){const a=T.languages.CompletionItemKind.Field;return[{label:"Firing",kind:a,detail:"Alert[]"},{label:"Resolved",kind:a,detail:"Alert[]"}]}function $(T){const a=T.languages.CompletionItemKind.Field;return[{label:"SortedPairs",kind:a,detail:"[]KeyValue"},{label:"Names",kind:a,detail:"[]string"},{label:"Values",kind:a,detail:"[]string"},{label:"Remove",detail:"KeyValue[] function(keys []string)",kind:T.languages.CompletionItemKind.Method}]}const G={alerts:{label:"alertsloop",description:"Renders a loop through alerts",snippet:u},alertDetails:{label:"alertdetails",description:"Renders all information available about the alert",snippet:M},groupLabels:{label:"grouplabelsloop",description:"Renders a loop through group labels",snippet:P},commonLabels:{label:"commonlabelsloop",description:"Renders a loop through common labels",snippet:R},commonAnnotations:{label:"commonannotationsloop",description:"Renders a loop through common annotations",snippet:W},labels:{label:"labelsloop",description:"Renders a loop through labels",snippet:e},annotations:{label:"annotationsloop",description:"Renders a loop through annotations",snippet:U}};function V(T){const a=T.languages.CompletionItemKind.Snippet,s=T.languages.CompletionItemInsertTextRule.InsertAsSnippet,{alerts:A,alertDetails:g,groupLabels:h,commonLabels:E,commonAnnotations:x,labels:l,annotations:C}=G;return[{label:A.label,documentation:A.description,kind:a,insertText:A.snippet,insertTextRules:s},{label:{label:g.label,detail:"(Alert)"},documentation:g.description,kind:a,insertText:g.snippet,insertTextRules:s},{label:h.label,documentation:h.description,kind:a,insertText:h.snippet,insertTextRules:s},{label:E.label,documentation:E.description,kind:a,insertText:E.snippet,insertTextRules:s},{label:x.label,documentation:x.description,kind:a,insertText:x.snippet,insertTextRules:s},{label:{label:l.label,detail:"(Alert)"},documentation:l.description,kind:a,insertText:l.snippet,insertTextRules:s},{label:{label:C.label,detail:"(Alert)"},documentation:C.description,kind:a,insertText:C.snippet,insertTextRules:s}]}},86768:(X,I,t)=>{t.d(I,{K:()=>M});var u=t(99494);const M={[u.W.OnCall]:"public/img/alerting/oncall_logo.svg",[u.W.Incident]:"",[u.W.MachineLearning]:""}},72275:(X,I,t)=>{t.d(I,{M:()=>R});var u=t(96540),M=t(56034),P=t(55852);const R=({tooltip:W,icon:e,to:U,target:N,onClick:z,className:K,tooltipPlacement:S="top",...$})=>{const G=typeof W=="string"?W:void 0;return u.createElement(M.m,{content:W,placement:S},U?u.createElement(P.z9,{variant:"secondary",fill:"text",icon:e,href:U,size:"sm",target:N,...$,"aria-label":G}):u.createElement(P.$n,{className:K,variant:"secondary",fill:"text",size:"sm",icon:e,type:"button",onClick:z,...$,"aria-label":G}))}},4554:(X,I,t)=>{t.d(I,{L:()=>M});var u=t(32196);const M=P=>({table:(0,u.css)`
    width: 100%;
    border-radius: ${P.shape.radius.default};
    border: solid 1px ${P.colors.border.weak};
    background-color: ${P.colors.background.secondary};

    th {
      padding: ${P.spacing(1)};
    }

    td {
      padding: 0 ${P.spacing(1)};
    }

    tr {
      height: 38px;
    }
  `,evenRow:(0,u.css)`
    background-color: ${P.colors.background.primary};
  `,colExpand:(0,u.css)`
    width: 36px;
  `,nameCell:(0,u.css)`
    gap: ${P.spacing(1)};
  `,actionsCell:(0,u.css)`
    text-align: right;
    width: 1%;
    white-space: nowrap;

    & > * + * {
      margin-left: ${P.spacing(.5)};
    }
  `})}}]);

//# sourceMappingURL=3726.cdb0caf7f23e3932d743.js.map