{"version":3,"file":"7914.2b1a06c504df18e20fe4.js","mappings":"wRA8BO,MAAMA,EAAa,CAAC,CAAE,YAAAC,CAAY,IAAa,CACpD,MAAMC,KAAY,MAAmB,EAC/B,CACJ,aAAAC,EACA,UAAW,CAAE,OAAAC,CAAO,EACpB,SAAAC,EACA,UAAAC,CACF,KAAI,MAAmB,CAAE,cAAe,CAAE,MAAOL,EAAY,MAAO,KAAMA,EAAY,IAAK,CAAE,CAAC,EAExFM,EAAW,MAAOC,GAAwB,CAC1CA,EAAS,OAAS,IACpB,OAAOA,EAAS,KAElB,OAAOA,EAAS,SAEC,QAAM,MAAc,EAClC,KAAK,yBAA0B,CAC9B,MAAOA,EAAS,MAChB,KAAMA,EAAS,KACf,SAAUA,EAAS,MACnB,QAASA,EAAS,QAClB,SAAUA,EAAS,SACnB,KAAMA,EAAS,IACjB,CAAC,EACA,MAAOC,GAAQ,CACd,MAAMC,EAAMD,EAAI,MAAM,SAAWA,EACjCP,EAAU,QAAQQ,CAAG,CACvB,CAAC,GAEU,OAAS,0BACpB,OAAO,SAAS,UAAO,MAAU,EAAE,UAAY,8BAA8B,EAE/E,OAAO,SAAS,UAAO,MAAU,EAAE,UAAY,GAAG,CACpD,EAEA,OACE,gBAAC,KAAW,KACV,gBAAC,KAAQ,KACP,gBAAC,QAAK,SAAUP,EAAaI,CAAQ,EAAG,MAAO,CAAE,MAAO,MAAO,GAC7D,gBAAC,IAAK,CAAC,MAAM,aACX,gBAAC,IAAK,CAAC,GAAG,YAAa,GAAGF,EAAS,MAAM,EAAG,YAAY,YAAa,EACvE,EACA,gBAAC,IAAK,CAAC,MAAM,QAAQ,QAAS,CAAC,CAACD,EAAO,MAAO,MAAOA,EAAO,OAAO,SACjE,gBAAC,KACC,GAAG,QACF,GAAGC,EAAS,QAAS,CACpB,SAAU,oBACV,QAAS,CACP,MAAO,KACP,QAAS,kBACX,CACF,CAAC,EACD,KAAK,QACL,YAAY,QACd,CACF,EACC,IAAC,MAAU,EAAE,eACZ,gBAAC,IAAK,CAAC,MAAM,aACX,gBAAC,IAAK,CAAC,GAAG,WAAY,GAAGA,EAAS,SAAS,EAAG,YAAY,WAAY,EACxE,KAED,MAAU,EAAE,oBACX,gBAAC,IAAK,CAAC,MAAM,gDACX,gBAAC,IAAK,CAAC,GAAG,oBAAqB,GAAGA,EAAS,MAAM,EAAG,YAAY,MAAO,EACzE,EAEF,gBAAC,IAAK,CAAC,MAAM,WAAW,QAAS,CAAC,CAACD,EAAO,SAAU,MAAOA,GAAQ,UAAU,SAC3E,gBAAC,KACC,GAAG,eACH,UAAS,GACT,aAAa,eACZ,GAAGC,EAAS,WAAY,CAAE,SAAU,sBAAuB,CAAC,EAC/D,CACF,EACA,gBAAC,IAAK,CAAC,MAAM,mBAAmB,QAAS,CAAC,CAACD,EAAO,QAAS,MAAOA,GAAQ,SAAS,SACjF,gBAAC,KACC,GAAG,uBACH,aAAa,eACZ,GAAGC,EAAS,UAAW,CACtB,SAAU,iCACV,SAAWM,GAAMA,IAAML,EAAU,EAAE,UAAY,uBACjD,CAAC,EACH,CACF,EAEA,gBAAC,IAAK,KACJ,gBAAC,KAAM,CAAC,KAAK,UAAS,QAAM,EAC5B,gBAAC,KAAU,CAAC,KAAK,OAAO,QAAM,MAAU,EAAE,UAAY,UAAU,eAEhE,CACF,CACF,CACF,CACF,CAEJ,EAEA,EAAeN,C","sources":["webpack://grafana/./public/app/core/components/Signup/SignupPage.tsx"],"sourcesContent":["import React from 'react';\nimport { useForm } from 'react-hook-form';\n\nimport { getBackendSrv } from '@grafana/runtime';\nimport { Field, Input, Button, LinkButton, Stack } from '@grafana/ui';\nimport { getConfig } from 'app/core/config';\nimport { useAppNotification } from 'app/core/copy/appNotification';\nimport { GrafanaRouteComponentProps } from 'app/core/navigation/types';\nimport { w3cStandardEmailValidator } from 'app/features/admin/utils';\n\nimport { InnerBox, LoginLayout } from '../Login/LoginLayout';\nimport { PasswordField } from '../PasswordField/PasswordField';\n\ninterface SignupDTO {\n  name?: string;\n  email: string;\n  username: string;\n  orgName?: string;\n  password: string;\n  code: string;\n  confirm?: string;\n}\n\ninterface QueryParams {\n  email?: string;\n  code?: string;\n}\n\ninterface Props extends GrafanaRouteComponentProps<{}, QueryParams> {}\n\nexport const SignupPage = ({ queryParams }: Props) => {\n  const notifyApp = useAppNotification();\n  const {\n    handleSubmit,\n    formState: { errors },\n    register,\n    getValues,\n  } = useForm<SignupDTO>({ defaultValues: { email: queryParams.email, code: queryParams.code } });\n\n  const onSubmit = async (formData: SignupDTO) => {\n    if (formData.name === '') {\n      delete formData.name;\n    }\n    delete formData.confirm;\n\n    const response = await getBackendSrv()\n      .post('/api/user/signup/step2', {\n        email: formData.email,\n        code: formData.code,\n        username: formData.email,\n        orgName: formData.orgName,\n        password: formData.password,\n        name: formData.name,\n      })\n      .catch((err) => {\n        const msg = err.data?.message || err;\n        notifyApp.warning(msg);\n      });\n\n    if (response.code === 'redirect-to-select-org') {\n      window.location.assign(getConfig().appSubUrl + '/profile/select-org?signup=1');\n    }\n    window.location.assign(getConfig().appSubUrl + '/');\n  };\n\n  return (\n    <LoginLayout>\n      <InnerBox>\n        <form onSubmit={handleSubmit(onSubmit)} style={{ width: '100%' }}>\n          <Field label=\"Your name\">\n            <Input id=\"user-name\" {...register('name')} placeholder=\"(optional)\" />\n          </Field>\n          <Field label=\"Email\" invalid={!!errors.email} error={errors.email?.message}>\n            <Input\n              id=\"email\"\n              {...register('email', {\n                required: 'Email is required',\n                pattern: {\n                  value: w3cStandardEmailValidator,\n                  message: 'Email is invalid',\n                },\n              })}\n              type=\"email\"\n              placeholder=\"Email\"\n            />\n          </Field>\n          {!getConfig().autoAssignOrg && (\n            <Field label=\"Org. name\">\n              <Input id=\"org-name\" {...register('orgName')} placeholder=\"Org. name\" />\n            </Field>\n          )}\n          {getConfig().verifyEmailEnabled && (\n            <Field label=\"Email verification code (sent to your email)\">\n              <Input id=\"verification-code\" {...register('code')} placeholder=\"Code\" />\n            </Field>\n          )}\n          <Field label=\"Password\" invalid={!!errors.password} error={errors?.password?.message}>\n            <PasswordField\n              id=\"new-password\"\n              autoFocus\n              autoComplete=\"new-password\"\n              {...register('password', { required: 'Password is required' })}\n            />\n          </Field>\n          <Field label=\"Confirm password\" invalid={!!errors.confirm} error={errors?.confirm?.message}>\n            <PasswordField\n              id=\"confirm-new-password\"\n              autoComplete=\"new-password\"\n              {...register('confirm', {\n                required: 'Confirmed password is required',\n                validate: (v) => v === getValues().password || 'Passwords must match!',\n              })}\n            />\n          </Field>\n\n          <Stack>\n            <Button type=\"submit\">Submit</Button>\n            <LinkButton fill=\"text\" href={getConfig().appSubUrl + '/login'}>\n              Back to login\n            </LinkButton>\n          </Stack>\n        </form>\n      </InnerBox>\n    </LoginLayout>\n  );\n};\n\nexport default SignupPage;\n"],"names":["SignupPage","queryParams","notifyApp","handleSubmit","errors","register","getValues","onSubmit","formData","err","msg","v"],"sourceRoot":""}